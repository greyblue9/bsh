public static Pair getClassFormat(byte[] b) { if (b == null) throw new IllegalArgumentException("getClassName(byte[] b): b == null"); if (b.length < 10) throw new IllegalArgumentException(String.format("Severely truncated class/dex input: length is %d (< 10 bytes)", b.length)); if (b[0] == (byte)'d' && b[1] == 'e' && (b[2] == 'x' || b[2] == 'y') && b[3] == 0x0A && b[4] == '0' && b[5] >= '3' && (b[6] >= '5' && b[6] <= '9')) { return Pair.of("dex", Integer.parseInt(new String(b, 4, 3, Charset.forName("ASCII")), 10)); } else if (0xCAFEBABE == Integer.reverseBytes(new ByteUtil().getInt(b, 0))) { int classVersion = Integer.reverseBytes(new ByteUtil().getInt(b, 4)); return Pair.of("class", classVersion); } else if (b[0] == 'P' && b[1] == 'K' && b[2] == 0x03 && b[3] == 0x04) { return Pair.of("zip", 0); } else return Pair.of("unknown", -1); }