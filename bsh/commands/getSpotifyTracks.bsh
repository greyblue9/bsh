import java.util.Map.Entry;
public static Map getSpotifyTracks() { File file = new File("/data/data/com.spotify.music/shared_prefs/spotify_preferences.xml"); String xml; (xml = FileUtils.readFileToString(file)).length(); org.w3c.dom.Document doc = com.android.utils.XmlUtils.parseDocument(xml, namespaceAware = false); Map map = RealArrayMap.toMap(doc.document.getChildNodes().children[0].children.select("""m => Pair.of(m.getAttributes(), Debug.ToString(m.getAttributes()));""").select("""m => ((org.w3c.dom.NamedNodeMap)m.getKey()).item(0)""").select("""m => Pair.of(m.getValue().toString(), ((org.w3c.dom.Node)((List)Reflect.getfldval(Reflect.getfldval(m, "ownerElement"),"children")).get(0)).getNodeValue())""")); Map trackMap; Map jsmap = new HashMap(); for (Entry e: map.entrySet()) { try { jsmap.put(e.getKey(), e.getValue().charAt(0) == '['? new org.json.JSONArray((String) e.getValue()): new org.json.JSONObject((String) e.getValue()).nameValuePairs); } catch (Throwable ex) { ; };; }; (trackMap = RealArrayMap.toMap(jsmap.get("radio-session-state-tracks").get("tracks").values.select("""m => Map map = ((Map)Reflect.getfldval(m, "nameValuePairs")); Map meta = (Map)Reflect.getfldval(map.get("metadata"), "nameValuePairs"); meta.put("uri", map.get("uri")); return Pair.of(map.get("uri"), meta); """))).entrySet(); Map tm2 = RealArrayMap.toMap(trackMap.entrySet().select("""m => Pair.of(((Map)m.getValue()).get("artist_name")+" - "+((Map)m.getValue()).get("title"), m.getValue())""")); return tm2; }

