
public static Pair parseHelp(String outputOrCmdName) { String output; if (outputOrCmdName.indexOf(' ') == -1) { String cmdName = outputOrCmdName; output = pexec(new String[]{ cmdName, "--help" }).getValue(); } else { output = outputOrCmdName; }; List options = output.matchAll("[^a-zA-Z0-9_$-](--?[A-Za-z-0-9_]+) ([a-zA-Z0-9_$-])"); List switches = output.matchAll(Pattern.compile("\\[(-[A-Za-z-0-9_]+|--[a-zA-Z0-9_$-]+)\\]", Pattern.DOTALL | Pattern.MULTILINE | Pattern.UNIX_LINES), "$1"); for (Iterator it = switches.iterator(); it.hasNext();) { String switchspec = it.next(); boolean isShort = (switchspec.length() < 2 || (switchspec.charAt(1) != '-' && switchspec.lastIndexOf('-') == 0)); if (isShort && switchspec.length() > 2) { char[] letters = switchspec.substring(1).toCharArray(); it.remove(); for (char letter: letters) { switches.add(String.format("-%c", letter)); }; break; } }; return Pair.of(options, switches); }

