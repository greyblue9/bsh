

public static void restoreGatherCache() { for (File file: new File("/data/local/dexSerialData/innerClassGathers").listFiles()) { System.err.printf("Loading stored inner class data from [%s] ...\n", file.getName()); InputStream fis = null; try { fis = new FileInputStream(file); ObjectInputStream ois = new ObjectInputStream(fis); Matcher nameMchr = Pattern.compile("dex_([0-9]+)_(.+)\\.icg\\.ser$").matcher(file.getName()); if (nameMchr.matches()) { com.googlecode.dex2jar.v3.V3InnerClzGather icg = (com.googlecode.dex2jar.v3.V3InnerClzGather) ois.readObject(); int size = Integer.parseInt(nameMchr.group(1), 10); String firstDefClassName = nameMchr.group(2); Class firstDefClass = Class.forName(firstDefClassName, false, Thread.currentThread().getContextClassLoader()); com.android.dex.Dex dex = org.d6r.ClassInfo.getDex(firstDefClass); Dex2Java.gatherCache.put(dex, icg); System.err.printf("Restored V3InnerClzGather [%d inner classes] for dex: %s\n", icg.getClasses().size(), dex); } } catch (Throwable ex) { ex.printStackTrace(); } finally { if (fis != null) IOUtils.closeQuietly(fis); } }; }

