String action = "org.d6r.SET_CLIP"; File tempFile = new File(PosixFileInputStream.pexecSync("mktemp", "-p", "/data/media/0")); FileUtils.writeByteArrayToFile(tempFile, IOUtils.toByteArray(new org.apache.commons.io.input.CloseShieldInputStream(System.in))); android.os.ParcelFileDescriptor pfd = android.os.ParcelFileDescriptor.open(tempFile, android.os.ParcelFileDescriptor.MODE_READ_ONLY); parcel = android.os.Parcel.obtain(); parcel.writeFileDescriptor(pfd.getFileDescriptor()); android.net.Uri.OpaqueUri ouri = null; (ouri = Reflect.allocateInstance(android.net.Uri.OpaqueUri.class)).fragment = android.net.Uri.Part.EmptyPart.EMPTY; ouri.ssp = android.net.Uri.Part.readFrom(parcel); ouri.scheme = "data:text/plain;base64,"; ouri.cachedString = String.format("%s<@%08x>...", ouri.scheme, ouri.ssp.hashCode()); android.content.Intent i = new android.content.Intent().setAction(action).addCategory("android.intent.category.DEFAULT").setData(ouri).setFlags(android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION | android.content.Intent.FLAG_GRANT_WRITE_URI_PERMISSION | android.content.Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION | android.content.Intent.FLAG_INCLUDE_STOPPED_PACKAGES | android.content.Intent.FLAG_RECEIVER_FOREGROUND); b = android.os.Bundle.forPair("text", FileUtils.readFileToString(tempFile, java.nio.charset.StandardCharsets.ISO_8859_1)); i.putExtras(b); i.setType("text/plain"); android.content.Context sysctx = android.app.ActivityThread.systemMain().getSystemContext(); sysctx.sendBroadcast(i.setComponent(android.content.ComponentName.unflattenFromString("com.farproc.clip.mem/.Receiver")));